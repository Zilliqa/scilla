let list_to_map =
  tfun 'A =>
  tfun 'B =>
  fun (l : List Pair 'A 'B) =>
    let folder = @list_foldl (Pair 'A 'B) (Map 'A 'B) in
    let init = Emp in
    let iter =
      fun (z : Map 'A 'B) =>
      fun (h : Pair 'A 'B) =>
        match h with
        | Pair a b =>
          builtin put z a b
        end
    in
      folder iter init l
in

let to_map = @list_to_map String Int in

let one = 1 in
let two = 2 in
let three = 3 in
let four = 4 in

let ones = "one" in
let twos = "two" in
let threes = "three" in
let fours = "four" in

let pair1 = Pair {String Int} ones one in
let pair2 = Pair {String Int} twos two in
let pair3 = Pair {String Int} threes three in
let pair4 = Pair {String Int} fours four in

let nil = Nil in
let l1 = Cons {Pair (String Int)} pair4 nil in
let l2 = Cons {Pair (String Int)} pair3 l1 in
let l3 = Cons {Pair (String Int)} pair2 l2 in
let l4 = Cons {Pair (String Int)} pair1 l3 in

to_map l4
