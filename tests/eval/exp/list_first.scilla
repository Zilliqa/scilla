let list_first_option =
  tfun 'A =>
  fun (l : List 'A) =>
    let iter = fun (i : Option 'A) => fun (j : 'A) =>
      match i with
      | Some a =>
        i
      | None =>
        Some {'A} j
      end
    in
    let init = None in
    let folder = @list_foldl 'A (Option 'A) in
      folder iter init l
in

let int_first = @list_first_option Int in

let one = 1 in
let two = 2 in
let three = 3 in
let nil = Nil in

let l1 = Cons {Int} two nil in
let l2 = Cons {Int} three l1 in
let l3 = Cons {Int} one l2 in
int_first l3
