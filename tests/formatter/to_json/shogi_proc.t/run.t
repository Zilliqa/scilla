  $ scilla-fmt --json --deannot shogi_proc.scilla
  {"smver":0,"libs":{"lname":["Ident",["SimpleLocal","Shogi"],null],"lentries":[["LibVar",["Ident",["SimpleLocal","move_east"],null],null,[["Fun",["Ident",["SimpleLocal","square"],null],["ADT",["Ident",["SimpleLocal","Square"],{"fname":"","lnum":0,"cnum":0}],[]],[["Let",["Ident",["SimpleLocal","one"],null],null,[["Literal","1"],null],[["MatchExpr",["Ident",["SimpleLocal","square"],null],[[["Constructor",["Ident",["SimpleLocal","Square"],null],[["Binder",["Ident",["SimpleLocal","row"],null]],["Binder",["Ident",["SimpleLocal","column"],null]]]],[["Let",["Ident",["SimpleLocal","new_column"],null],null,[["Builtin",[["Builtin_add"],null],[],[["Ident",["SimpleLocal","column"],null],["Ident",["SimpleLocal","one"],null]]],null],[["Constr",["Ident",["SimpleLocal","Square"],null],[],[["Ident",["SimpleLocal","row"],null],["Ident",["SimpleLocal","new_column"],null]]],null]],null]]]],null]],null]],null]],["LibVar",["Ident",["SimpleLocal","move_southeast"],null],null,[["Fun",["Ident",["SimpleLocal","square"],null],["ADT",["Ident",["SimpleLocal","Square"],{"fname":"","lnum":0,"cnum":0}],[]],[["Let",["Ident",["SimpleLocal","one"],null],null,[["Literal","1"],null],[["MatchExpr",["Ident",["SimpleLocal","square"],null],[[["Constructor",["Ident",["SimpleLocal","Square"],null],[["Binder",["Ident",["SimpleLocal","row"],null]],["Binder",["Ident",["SimpleLocal","column"],null]]]],[["Let",["Ident",["SimpleLocal","new_column"],null],null,[["Builtin",[["Builtin_add"],null],[],[["Ident",["SimpleLocal","column"],null],["Ident",["SimpleLocal","one"],null]]],null],[["Let",["Ident",["SimpleLocal","new_row"],null],null,[["Builtin",[["Builtin_sub"],null],[],[["Ident",["SimpleLocal","row"],null],["Ident",["SimpleLocal","one"],null]]],null],[["Constr",["Ident",["SimpleLocal","Square"],null],[],[["Ident",["SimpleLocal","new_row"],null],["Ident",["SimpleLocal","new_column"],null]]],null]],null]],null]]]],null]],null]],null]],["LibVar",["Ident",["SimpleLocal","move_south"],null],null,[["Fun",["Ident",["SimpleLocal","square"],null],["ADT",["Ident",["SimpleLocal","Square"],{"fname":"","lnum":0,"cnum":0}],[]],[["Let",["Ident",["SimpleLocal","one"],null],null,[["Literal","1"],null],[["MatchExpr",["Ident",["SimpleLocal","square"],null],[[["Constructor",["Ident",["SimpleLocal","Square"],null],[["Binder",["Ident",["SimpleLocal","row"],null]],["Binder",["Ident",["SimpleLocal","column"],null]]]],[["Let",["Ident",["SimpleLocal","new_row"],null],null,[["Builtin",[["Builtin_sub"],null],[],[["Ident",["SimpleLocal","row"],null],["Ident",["SimpleLocal","one"],null]]],null],[["Constr",["Ident",["SimpleLocal","Square"],null],[],[["Ident",["SimpleLocal","new_row"],null],["Ident",["SimpleLocal","column"],null]]],null]],null]]]],null]],null]],null]],["LibVar",["Ident",["SimpleLocal","move_southwest"],null],null,[["Fun",["Ident",["SimpleLocal","square"],null],["ADT",["Ident",["SimpleLocal","Square"],{"fname":"","lnum":0,"cnum":0}],[]],[["Let",["Ident",["SimpleLocal","one"],null],null,[["Literal","1"],null],[["MatchExpr",["Ident",["SimpleLocal","square"],null],[[["Constructor",["Ident",["SimpleLocal","Square"],null],[["Binder",["Ident",["SimpleLocal","row"],null]],["Binder",["Ident",["SimpleLocal","column"],null]]]],[["Let",["Ident",["SimpleLocal","new_column"],null],null,[["Builtin",[["Builtin_sub"],null],[],[["Ident",["SimpleLocal","column"],null],["Ident",["SimpleLocal","one"],null]]],null],[["Let",["Ident",["SimpleLocal","new_row"],null],null,[["Builtin",[["Builtin_sub"],null],[],[["Ident",["SimpleLocal","row"],null],["Ident",["SimpleLocal","one"],null]]],null],[["Constr",["Ident",["SimpleLocal","Square"],null],[],[["Ident",["SimpleLocal","new_row"],null],["Ident",["SimpleLocal","new_column"],null]]],null]],null]],null]]]],null]],null]],null]],["LibVar",["Ident",["SimpleLocal","move_west"],null],null,[["Fun",["Ident",["SimpleLocal","square"],null],["ADT",["Ident",["SimpleLocal","Square"],{"fname":"","lnum":0,"cnum":0}],[]],[["Let",["Ident",["SimpleLocal","one"],null],null,[["Literal","1"],null],[["MatchExpr",["Ident",["SimpleLocal","square"],null],[[["Constructor",["Ident",["SimpleLocal","Square"],null],[["Binder",["Ident",["SimpleLocal","row"],null]],["Binder",["Ident",["SimpleLocal","column"],null]]]],[["Let",["Ident",["SimpleLocal","new_column"],null],null,[["Builtin",[["Builtin_sub"],null],[],[["Ident",["SimpleLocal","column"],null],["Ident",["SimpleLocal","one"],null]]],null],[["Constr",["Ident",["SimpleLocal","Square"],null],[],[["Ident",["SimpleLocal","row"],null],["Ident",["SimpleLocal","new_column"],null]]],null]],null]]]],null]],null]],null]],["LibVar",["Ident",["SimpleLocal","move_northwest"],null],null,[["Fun",["Ident",["SimpleLocal","square"],null],["ADT",["Ident",["SimpleLocal","Square"],{"fname":"","lnum":0,"cnum":0}],[]],[["Let",["Ident",["SimpleLocal","one"],null],null,[["Literal","1"],null],[["MatchExpr",["Ident",["SimpleLocal","square"],null],[[["Constructor",["Ident",["SimpleLocal","Square"],null],[["Binder",["Ident",["SimpleLocal","row"],null]],["Binder",["Ident",["SimpleLocal","column"],null]]]],[["Let",["Ident",["SimpleLocal","new_column"],null],null,[["Builtin",[["Builtin_sub"],null],[],[["Ident",["SimpleLocal","column"],null],["Ident",["SimpleLocal","one"],null]]],null],[["Let",["Ident",["SimpleLocal","new_row"],null],null,[["Builtin",[["Builtin_add"],null],[],[["Ident",["SimpleLocal","row"],null],["Ident",["SimpleLocal","one"],null]]],null],[["Constr",["Ident",["SimpleLocal","Square"],null],[],[["Ident",["SimpleLocal","new_row"],null],["Ident",["SimpleLocal","new_column"],null]]],null]],null]],null]]]],null]],null]],null]],["LibVar",["Ident",["SimpleLocal","move_north"],null],null,[["Fun",["Ident",["SimpleLocal","square"],null],["ADT",["Ident",["SimpleLocal","Square"],{"fname":"","lnum":0,"cnum":0}],[]],[["Let",["Ident",["SimpleLocal","one"],null],null,[["Literal","1"],null],[["MatchExpr",["Ident",["SimpleLocal","square"],null],[[["Constructor",["Ident",["SimpleLocal","Square"],null],[["Binder",["Ident",["SimpleLocal","row"],null]],["Binder",["Ident",["SimpleLocal","column"],null]]]],[["Let",["Ident",["SimpleLocal","new_row"],null],null,[["Builtin",[["Builtin_add"],null],[],[["Ident",["SimpleLocal","row"],null],["Ident",["SimpleLocal","one"],null]]],null],[["Constr",["Ident",["SimpleLocal","Square"],null],[],[["Ident",["SimpleLocal","new_row"],null],["Ident",["SimpleLocal","column"],null]]],null]],null]]]],null]],null]],null]],["LibVar",["Ident",["SimpleLocal","move_northeast"],null],null,[["Fun",["Ident",["SimpleLocal","square"],null],["ADT",["Ident",["SimpleLocal","Square"],{"fname":"","lnum":0,"cnum":0}],[]],[["Let",["Ident",["SimpleLocal","one"],null],null,[["Literal","1"],null],[["MatchExpr",["Ident",["SimpleLocal","square"],null],[[["Constructor",["Ident",["SimpleLocal","Square"],null],[["Binder",["Ident",["SimpleLocal","row"],null]],["Binder",["Ident",["SimpleLocal","column"],null]]]],[["Let",["Ident",["SimpleLocal","new_column"],null],null,[["Builtin",[["Builtin_add"],null],[],[["Ident",["SimpleLocal","column"],null],["Ident",["SimpleLocal","one"],null]]],null],[["Let",["Ident",["SimpleLocal","new_row"],null],null,[["Builtin",[["Builtin_add"],null],[],[["Ident",["SimpleLocal","row"],null],["Ident",["SimpleLocal","one"],null]]],null],[["Constr",["Ident",["SimpleLocal","Square"],null],[],[["Ident",["SimpleLocal","new_row"],null],["Ident",["SimpleLocal","new_column"],null]]],null]],null]],null]]]],null]],null]],null]],["LibVar",["Ident",["SimpleLocal","move_one_square"],null],null,[["Fun",["Ident",["SimpleLocal","square"],null],["ADT",["Ident",["SimpleLocal","Square"],{"fname":"","lnum":0,"cnum":0}],[]],[["Fun",["Ident",["SimpleLocal","direction"],null],["ADT",["Ident",["SimpleLocal","Direction"],{"fname":"","lnum":0,"cnum":0}],[]],[["MatchExpr",["Ident",["SimpleLocal","direction"],null],[[["Constructor",["Ident",["SimpleLocal","East"],null],[]],[["App",["Ident",["SimpleLocal","move_east"],null],[["Ident",["SimpleLocal","square"],null]]],null]],[["Constructor",["Ident",["SimpleLocal","SouthEast"],null],[]],[["App",["Ident",["SimpleLocal","move_southeast"],null],[["Ident",["SimpleLocal","square"],null]]],null]],[["Constructor",["Ident",["SimpleLocal","South"],null],[]],[["App",["Ident",["SimpleLocal","move_south"],null],[["Ident",["SimpleLocal","square"],null]]],null]],[["Constructor",["Ident",["SimpleLocal","SouthWest"],null],[]],[["App",["Ident",["SimpleLocal","move_southwest"],null],[["Ident",["SimpleLocal","square"],null]]],null]],[["Constructor",["Ident",["SimpleLocal","West"],null],[]],[["App",["Ident",["SimpleLocal","move_west"],null],[["Ident",["SimpleLocal","square"],null]]],null]],[["Constructor",["Ident",["SimpleLocal","NorthWest"],null],[]],[["App",["Ident",["SimpleLocal","move_northwest"],null],[["Ident",["SimpleLocal","square"],null]]],null]],[["Constructor",["Ident",["SimpleLocal","North"],null],[]],[["App",["Ident",["SimpleLocal","move_north"],null],[["Ident",["SimpleLocal","square"],null]]],null]],[["Constructor",["Ident",["SimpleLocal","NorthEast"],null],[]],[["App",["Ident",["SimpleLocal","move_northeast"],null],[["Ident",["SimpleLocal","square"],null]]],null]]]],null]],null]],null]],["LibVar",["Ident",["SimpleLocal","generate_path"],null],null,[["Fun",["Ident",["SimpleLocal","origin"],null],["ADT",["Ident",["SimpleLocal","Square"],{"fname":"","lnum":0,"cnum":0}],[]],[["Fun",["Ident",["SimpleLocal","direction"],null],["ADT",["Ident",["SimpleLocal","Direction"],{"fname":"","lnum":0,"cnum":0}],[]],[["Fun",["Ident",["SimpleLocal","distance"],null],["PrimType",["Uint_typ",["Bits32"]]],[["Let",["Ident",["SimpleLocal","distance_as_nat"],null],null,[["Builtin",[["Builtin_to_nat"],null],[],[["Ident",["SimpleLocal","distance"],null]]],null],[["Let",["Ident",["SimpleLocal","init"],null],null,[["Constr",["Ident",["SimpleLocal","Nil"],null],[["ADT",["Ident",["SimpleLocal","Square"],{"fname":"","lnum":0,"cnum":0}],[]]],[]],null],[["Let",["Ident",["SimpleLocal","folder"],null],null,[["TApp",["Ident",["SimpleLocal","nat_fold"],null],[["ADT",["Ident",["SimpleLocal","List"],{"fname":"","lnum":0,"cnum":0}],[["ADT",["Ident",["SimpleLocal","Square"],{"fname":"","lnum":0,"cnum":0}],[]]]]]],null],[["Let",["Ident",["SimpleLocal","f"],null],null,[["Fun",["Ident",["SimpleLocal","acc"],null],["ADT",["Ident",["SimpleLocal","List"],{"fname":"","lnum":0,"cnum":0}],[["ADT",["Ident",["SimpleLocal","Square"],{"fname":"","lnum":0,"cnum":0}],[]]]],[["Fun",["Ident",["SimpleLocal","count"],null],["ADT",["Ident",["SimpleLocal","Nat"],{"fname":"","lnum":0,"cnum":0}],[]],[["Let",["Ident",["SimpleLocal","last_square"],null],null,[["MatchExpr",["Ident",["SimpleLocal","acc"],null],[[["Constructor",["Ident",["SimpleLocal","Cons"],null],[["Binder",["Ident",["SimpleLocal","s"],null]],["Wildcard"]]],[["Var",["Ident",["SimpleLocal","s"],null]],null]],[["Constructor",["Ident",["SimpleLocal","Nil"],null],[]],[["Var",["Ident",["SimpleLocal","origin"],null]],null]]]],null],[["Let",["Ident",["SimpleLocal","off_the_board"],null],null,[["MatchExpr",["Ident",["SimpleLocal","last_square"],null],[[["Constructor",["Ident",["SimpleLocal","Square"],null],[["Binder",["Ident",["SimpleLocal","row"],null]],["Binder",["Ident",["SimpleLocal","column"],null]]]],[["Let",["Ident",["SimpleLocal","zero"],null],null,[["Literal","0"],null],[["Let",["Ident",["SimpleLocal","ten"],null],null,[["Literal","10"],null],[["Let",["Ident",["SimpleLocal","too_far_east"],null],null,[["Builtin",[["Builtin_eq"],null],[],[["Ident",["SimpleLocal","zero"],null],["Ident",["SimpleLocal","column"],null]]],null],[["Let",["Ident",["SimpleLocal","too_far_west"],null],null,[["Builtin",[["Builtin_eq"],null],[],[["Ident",["SimpleLocal","ten"],null],["Ident",["SimpleLocal","column"],null]]],null],[["Let",["Ident",["SimpleLocal","too_far_south"],null],null,[["Builtin",[["Builtin_eq"],null],[],[["Ident",["SimpleLocal","zero"],null],["Ident",["SimpleLocal","row"],null]]],null],[["Let",["Ident",["SimpleLocal","too_far_north"],null],null,[["Builtin",[["Builtin_eq"],null],[],[["Ident",["SimpleLocal","ten"],null],["Ident",["SimpleLocal","row"],null]]],null],[["Let",["Ident",["SimpleLocal","colum_fail"],null],null,[["App",["Ident",["SimpleLocal","orb"],null],[["Ident",["SimpleLocal","too_far_east"],null],["Ident",["SimpleLocal","too_far_west"],null]]],null],[["Let",["Ident",["SimpleLocal","row_fail"],null],null,[["App",["Ident",["SimpleLocal","orb"],null],[["Ident",["SimpleLocal","too_far_north"],null],["Ident",["SimpleLocal","too_far_south"],null]]],null],[["App",["Ident",["SimpleLocal","orb"],null],[["Ident",["SimpleLocal","colum_fail"],null],["Ident",["SimpleLocal","row_fail"],null]]],null]],null]],null]],null]],null]],null]],null]],null]],null]]]],null],[["MatchExpr",["Ident",["SimpleLocal","off_the_board"],null],[[["Constructor",["Ident",["SimpleLocal","True"],null],[]],[["Var",["Ident",["SimpleLocal","acc"],null]],null]],[["Constructor",["Ident",["SimpleLocal","False"],null],[]],[["Let",["Ident",["SimpleLocal","next_square"],null],null,[["App",["Ident",["SimpleLocal","move_one_square"],null],[["Ident",["SimpleLocal","last_square"],null],["Ident",["SimpleLocal","direction"],null]]],null],[["Constr",["Ident",["SimpleLocal","Cons"],null],[["ADT",["Ident",["SimpleLocal","Square"],{"fname":"","lnum":0,"cnum":0}],[]]],[["Ident",["SimpleLocal","next_square"],null],["Ident",["SimpleLocal","acc"],null]]],null]],null]]]],null]],null]],null]],null]],null],[["App",["Ident",["SimpleLocal","folder"],null],[["Ident",["SimpleLocal","f"],null],["Ident",["SimpleLocal","init"],null],["Ident",["SimpleLocal","distance_as_nat"],null]]],null]],null]],null]],null]],null]],null]],null]],null]],["LibVar",["Ident",["SimpleLocal","king_path"],null],null,[["Fun",["Ident",["SimpleLocal","square"],null],["ADT",["Ident",["SimpleLocal","Square"],{"fname":"","lnum":0,"cnum":0}],[]],[["Fun",["Ident",["SimpleLocal","direction"],null],["ADT",["Ident",["SimpleLocal","Direction"],{"fname":"","lnum":0,"cnum":0}],[]],[["Let",["Ident",["SimpleLocal","one"],null],null,[["Literal","1"],null],[["App",["Ident",["SimpleLocal","generate_path"],null],[["Ident",["SimpleLocal","square"],null],["Ident",["SimpleLocal","direction"],null],["Ident",["SimpleLocal","one"],null]]],null]],null]],null]],null]],["LibVar",["Ident",["SimpleLocal","gold_path"],null],null,[["Fun",["Ident",["SimpleLocal","square"],null],["ADT",["Ident",["SimpleLocal","Square"],{"fname":"","lnum":0,"cnum":0}],[]],[["Fun",["Ident",["SimpleLocal","direction"],null],["ADT",["Ident",["SimpleLocal","Direction"],{"fname":"","lnum":0,"cnum":0}],[]],[["Fun",["Ident",["SimpleLocal","player_1_in_turn"],null],["ADT",["Ident",["SimpleLocal","Bool"],{"fname":"","lnum":0,"cnum":0}],[]],[["MatchExpr",["Ident",["SimpleLocal","player_1_in_turn"],null],[[["Constructor",["Ident",["SimpleLocal","True"],null],[]],[["MatchExpr",["Ident",["SimpleLocal","direction"],null],[[["Constructor",["Ident",["SimpleLocal","SouthWest"],null],[]],[["Constr",["Ident",["SimpleLocal","Nil"],null],[["ADT",["Ident",["SimpleLocal","Square"],{"fname":"","lnum":0,"cnum":0}],[]]],[]],null]],[["Constructor",["Ident",["SimpleLocal","SouthEast"],null],[]],[["Constr",["Ident",["SimpleLocal","Nil"],null],[["ADT",["Ident",["SimpleLocal","Square"],{"fname":"","lnum":0,"cnum":0}],[]]],[]],null]],[["Wildcard"],[["Let",["Ident",["SimpleLocal","one"],null],null,[["Literal","1"],null],[["App",["Ident",["SimpleLocal","generate_path"],null],[["Ident",["SimpleLocal","square"],null],["Ident",["SimpleLocal","direction"],null],["Ident",["SimpleLocal","one"],null]]],null]],null]]]],null]],[["Constructor",["Ident",["SimpleLocal","False"],null],[]],[["MatchExpr",["Ident",["SimpleLocal","direction"],null],[[["Constructor",["Ident",["SimpleLocal","NorthWest"],null],[]],[["Constr",["Ident",["SimpleLocal","Nil"],null],[["ADT",["Ident",["SimpleLocal","Square"],{"fname":"","lnum":0,"cnum":0}],[]]],[]],null]],[["Constructor",["Ident",["SimpleLocal","NorthEast"],null],[]],[["Constr",["Ident",["SimpleLocal","Nil"],null],[["ADT",["Ident",["SimpleLocal","Square"],{"fname":"","lnum":0,"cnum":0}],[]]],[]],null]],[["Wildcard"],[["Let",["Ident",["SimpleLocal","one"],null],null,[["Literal","1"],null],[["App",["Ident",["SimpleLocal","generate_path"],null],[["Ident",["SimpleLocal","square"],null],["Ident",["SimpleLocal","direction"],null],["Ident",["SimpleLocal","one"],null]]],null]],null]]]],null]]]],null]],null]],null]],null]],["LibVar",["Ident",["SimpleLocal","silver_path"],null],null,[["Fun",["Ident",["SimpleLocal","square"],null],["ADT",["Ident",["SimpleLocal","Square"],{"fname":"","lnum":0,"cnum":0}],[]],[["Fun",["Ident",["SimpleLocal","direction"],null],["ADT",["Ident",["SimpleLocal","Direction"],{"fname":"","lnum":0,"cnum":0}],[]],[["Fun",["Ident",["SimpleLocal","player_1_in_turn"],null],["ADT",["Ident",["SimpleLocal","Bool"],{"fname":"","lnum":0,"cnum":0}],[]],[["MatchExpr",["Ident",["SimpleLocal","player_1_in_turn"],null],[[["Constructor",["Ident",["SimpleLocal","True"],null],[]],[["MatchExpr",["Ident",["SimpleLocal","direction"],null],[[["Constructor",["Ident",["SimpleLocal","South"],null],[]],[["Constr",["Ident",["SimpleLocal","Nil"],null],[["ADT",["Ident",["SimpleLocal","Square"],{"fname":"","lnum":0,"cnum":0}],[]]],[]],null]],[["Constructor",["Ident",["SimpleLocal","East"],null],[]],[["Constr",["Ident",["SimpleLocal","Nil"],null],[["ADT",["Ident",["SimpleLocal","Square"],{"fname":"","lnum":0,"cnum":0}],[]]],[]],null]],[["Constructor",["Ident",["SimpleLocal","West"],null],[]],[["Constr",["Ident",["SimpleLocal","Nil"],null],[["ADT",["Ident",["SimpleLocal","Square"],{"fname":"","lnum":0,"cnum":0}],[]]],[]],null]],[["Wildcard"],[["Let",["Ident",["SimpleLocal","one"],null],null,[["Literal","1"],null],[["App",["Ident",["SimpleLocal","generate_path"],null],[["Ident",["SimpleLocal","square"],null],["Ident",["SimpleLocal","direction"],null],["Ident",["SimpleLocal","one"],null]]],null]],null]]]],null]],[["Constructor",["Ident",["SimpleLocal","False"],null],[]],[["MatchExpr",["Ident",["SimpleLocal","direction"],null],[[["Constructor",["Ident",["SimpleLocal","North"],null],[]],[["Constr",["Ident",["SimpleLocal","Nil"],null],[["ADT",["Ident",["SimpleLocal","Square"],{"fname":"","lnum":0,"cnum":0}],[]]],[]],null]],[["Constructor",["Ident",["SimpleLocal","East"],null],[]],[["Constr",["Ident",["SimpleLocal","Nil"],null],[["ADT",["Ident",["SimpleLocal","Square"],{"fname":"","lnum":0,"cnum":0}],[]]],[]],null]],[["Constructor",["Ident",["SimpleLocal","West"],null],[]],[["Constr",["Ident",["SimpleLocal","Nil"],null],[["ADT",["Ident",["SimpleLocal","Square"],{"fname":"","lnum":0,"cnum":0}],[]]],[]],null]],[["Wildcard"],[["Let",["Ident",["SimpleLocal","one"],null],null,[["Literal","1"],null],[["App",["Ident",["SimpleLocal","generate_path"],null],[["Ident",["SimpleLocal","square"],null],["Ident",["SimpleLocal","direction"],null],["Ident",["SimpleLocal","one"],null]]],null]],null]]]],null]]]],null]],null]],null]],null]],["LibVar",["Ident",["SimpleLocal","knight_path"],null],null,[["Fun",["Ident",["SimpleLocal","square"],null],["ADT",["Ident",["SimpleLocal","Square"],{"fname":"","lnum":0,"cnum":0}],[]],[["Fun",["Ident",["SimpleLocal","direction"],null],["ADT",["Ident",["SimpleLocal","Direction"],{"fname":"","lnum":0,"cnum":0}],[]],[["Fun",["Ident",["SimpleLocal","player_1_in_turn"],null],["ADT",["Ident",["SimpleLocal","Bool"],{"fname":"","lnum":0,"cnum":0}],[]],[["MatchExpr",["Ident",["SimpleLocal","player_1_in_turn"],null],[[["Constructor",["Ident",["SimpleLocal","True"],null],[]],[["Let",["Ident",["SimpleLocal","north"],null],null,[["Constr",["Ident",["SimpleLocal","North"],null],[],[]],null],[["MatchExpr",["Ident",["SimpleLocal","direction"],null],[[["Constructor",["Ident",["SimpleLocal","NorthEast"],null],[]],[["Let",["Ident",["SimpleLocal","nil_path"],null],null,[["Constr",["Ident",["SimpleLocal","Nil"],null],[["ADT",["Ident",["SimpleLocal","Square"],{"fname":"","lnum":0,"cnum":0}],[]]],[]],null],[["Let",["Ident",["SimpleLocal","first_square"],null],null,[["App",["Ident",["SimpleLocal","move_one_square"],null],[["Ident",["SimpleLocal","square"],null],["Ident",["SimpleLocal","north"],null]]],null],[["Let",["Ident",["SimpleLocal","final_square"],null],null,[["App",["Ident",["SimpleLocal","move_one_square"],null],[["Ident",["SimpleLocal","first_square"],null],["Ident",["SimpleLocal","direction"],null]]],null],[["Constr",["Ident",["SimpleLocal","Cons"],null],[["ADT",["Ident",["SimpleLocal","Square"],{"fname":"","lnum":0,"cnum":0}],[]]],[["Ident",["SimpleLocal","final_square"],null],["Ident",["SimpleLocal","nil_path"],null]]],null]],null]],null]],null]],[["Constructor",["Ident",["SimpleLocal","NorthWest"],null],[]],[["Let",["Ident",["SimpleLocal","nil_path"],null],null,[["Constr",["Ident",["SimpleLocal","Nil"],null],[["ADT",["Ident",["SimpleLocal","Square"],{"fname":"","lnum":0,"cnum":0}],[]]],[]],null],[["Let",["Ident",["SimpleLocal","first_square"],null],null,[["App",["Ident",["SimpleLocal","move_one_square"],null],[["Ident",["SimpleLocal","square"],null],["Ident",["SimpleLocal","north"],null]]],null],[["Let",["Ident",["SimpleLocal","final_square"],null],null,[["App",["Ident",["SimpleLocal","move_one_square"],null],[["Ident",["SimpleLocal","first_square"],null],["Ident",["SimpleLocal","direction"],null]]],null],[["Constr",["Ident",["SimpleLocal","Cons"],null],[["ADT",["Ident",["SimpleLocal","Square"],{"fname":"","lnum":0,"cnum":0}],[]]],[["Ident",["SimpleLocal","final_square"],null],["Ident",["SimpleLocal","nil_path"],null]]],null]],null]],null]],null]],[["Wildcard"],[["Constr",["Ident",["SimpleLocal","Nil"],null],[["ADT",["Ident",["SimpleLocal","Square"],{"fname":"","lnum":0,"cnum":0}],[]]],[]],null]]]],null]],null]],[["Constructor",["Ident",["SimpleLocal","False"],null],[]],[["Let",["Ident",["SimpleLocal","south"],null],null,[["Constr",["Ident",["SimpleLocal","South"],null],[],[]],null],[["MatchExpr",["Ident",["SimpleLocal","direction"],null],[[["Constructor",["Ident",["SimpleLocal","SouthEast"],null],[]],[["Let",["Ident",["SimpleLocal","nil_path"],null],null,[["Constr",["Ident",["SimpleLocal","Nil"],null],[["ADT",["Ident",["SimpleLocal","Square"],{"fname":"","lnum":0,"cnum":0}],[]]],[]],null],[["Let",["Ident",["SimpleLocal","first_square"],null],null,[["App",["Ident",["SimpleLocal","move_one_square"],null],[["Ident",["SimpleLocal","square"],null],["Ident",["SimpleLocal","south"],null]]],null],[["Let",["Ident",["SimpleLocal","final_square"],null],null,[["App",["Ident",["SimpleLocal","move_one_square"],null],[["Ident",["SimpleLocal","first_square"],null],["Ident",["SimpleLocal","direction"],null]]],null],[["Constr",["Ident",["SimpleLocal","Cons"],null],[["ADT",["Ident",["SimpleLocal","Square"],{"fname":"","lnum":0,"cnum":0}],[]]],[["Ident",["SimpleLocal","final_square"],null],["Ident",["SimpleLocal","nil_path"],null]]],null]],null]],null]],null]],[["Constructor",["Ident",["SimpleLocal","SouthWest"],null],[]],[["Let",["Ident",["SimpleLocal","nil_path"],null],null,[["Constr",["Ident",["SimpleLocal","Nil"],null],[["ADT",["Ident",["SimpleLocal","Square"],{"fname":"","lnum":0,"cnum":0}],[]]],[]],null],[["Let",["Ident",["SimpleLocal","first_square"],null],null,[["App",["Ident",["SimpleLocal","move_one_square"],null],[["Ident",["SimpleLocal","square"],null],["Ident",["SimpleLocal","south"],null]]],null],[["Let",["Ident",["SimpleLocal","final_square"],null],null,[["App",["Ident",["SimpleLocal","move_one_square"],null],[["Ident",["SimpleLocal","first_square"],null],["Ident",["SimpleLocal","direction"],null]]],null],[["Constr",["Ident",["SimpleLocal","Cons"],null],[["ADT",["Ident",["SimpleLocal","Square"],{"fname":"","lnum":0,"cnum":0}],[]]],[["Ident",["SimpleLocal","final_square"],null],["Ident",["SimpleLocal","nil_path"],null]]],null]],null]],null]],null]],[["Wildcard"],[["Constr",["Ident",["SimpleLocal","Nil"],null],[["ADT",["Ident",["SimpleLocal","Square"],{"fname":"","lnum":0,"cnum":0}],[]]],[]],null]]]],null]],null]]]],null]],null]],null]],null]],["LibVar",["Ident",["SimpleLocal","pawn_path"],null],null,[["Fun",["Ident",["SimpleLocal","square"],null],["ADT",["Ident",["SimpleLocal","Square"],{"fname":"","lnum":0,"cnum":0}],[]],[["Fun",["Ident",["SimpleLocal","direction"],null],["ADT",["Ident",["SimpleLocal","Direction"],{"fname":"","lnum":0,"cnum":0}],[]],[["Fun",["Ident",["SimpleLocal","player_1_in_turn"],null],["ADT",["Ident",["SimpleLocal","Bool"],{"fname":"","lnum":0,"cnum":0}],[]],[["MatchExpr",["Ident",["SimpleLocal","player_1_in_turn"],null],[[["Constructor",["Ident",["SimpleLocal","True"],null],[]],[["MatchExpr",["Ident",["SimpleLocal","direction"],null],[[["Constructor",["Ident",["SimpleLocal","North"],null],[]],[["Let",["Ident",["SimpleLocal","one"],null],null,[["Literal","1"],null],[["App",["Ident",["SimpleLocal","generate_path"],null],[["Ident",["SimpleLocal","square"],null],["Ident",["SimpleLocal","direction"],null],["Ident",["SimpleLocal","one"],null]]],null]],null]],[["Wildcard"],[["Constr",["Ident",["SimpleLocal","Nil"],null],[["ADT",["Ident",["SimpleLocal","Square"],{"fname":"","lnum":0,"cnum":0}],[]]],[]],null]]]],null]],[["Constructor",["Ident",["SimpleLocal","False"],null],[]],[["MatchExpr",["Ident",["SimpleLocal","direction"],null],[[["Constructor",["Ident",["SimpleLocal","South"],null],[]],[["Let",["Ident",["SimpleLocal","one"],null],null,[["Literal","1"],null],[["App",["Ident",["SimpleLocal","generate_path"],null],[["Ident",["SimpleLocal","square"],null],["Ident",["SimpleLocal","direction"],null],["Ident",["SimpleLocal","one"],null]]],null]],null]],[["Wildcard"],[["Constr",["Ident",["SimpleLocal","Nil"],null],[["ADT",["Ident",["SimpleLocal","Square"],{"fname":"","lnum":0,"cnum":0}],[]]],[]],null]]]],null]]]],null]],null]],null]],null]],["LibVar",["Ident",["SimpleLocal","lance_path"],null],null,[["Fun",["Ident",["SimpleLocal","square"],null],["ADT",["Ident",["SimpleLocal","Square"],{"fname":"","lnum":0,"cnum":0}],[]],[["Fun",["Ident",["SimpleLocal","direction"],null],["ADT",["Ident",["SimpleLocal","Direction"],{"fname":"","lnum":0,"cnum":0}],[]],[["Fun",["Ident",["SimpleLocal","distance"],null],["PrimType",["Uint_typ",["Bits32"]]],[["Fun",["Ident",["SimpleLocal","player_1_in_turn"],null],["ADT",["Ident",["SimpleLocal","Bool"],{"fname":"","lnum":0,"cnum":0}],[]],[["MatchExpr",["Ident",["SimpleLocal","player_1_in_turn"],null],[[["Constructor",["Ident",["SimpleLocal","True"],null],[]],[["MatchExpr",["Ident",["SimpleLocal","direction"],null],[[["Constructor",["Ident",["SimpleLocal","North"],null],[]],[["App",["Ident",["SimpleLocal","generate_path"],null],[["Ident",["SimpleLocal","square"],null],["Ident",["SimpleLocal","direction"],null],["Ident",["SimpleLocal","distance"],null]]],null]],[["Wildcard"],[["Constr",["Ident",["SimpleLocal","Nil"],null],[["ADT",["Ident",["SimpleLocal","Square"],{"fname":"","lnum":0,"cnum":0}],[]]],[]],null]]]],null]],[["Constructor",["Ident",["SimpleLocal","False"],null],[]],[["MatchExpr",["Ident",["SimpleLocal","direction"],null],[[["Constructor",["Ident",["SimpleLocal","South"],null],[]],[["App",["Ident",["SimpleLocal","generate_path"],null],[["Ident",["SimpleLocal","square"],null],["Ident",["SimpleLocal","direction"],null],["Ident",["SimpleLocal","distance"],null]]],null]],[["Wildcard"],[["Constr",["Ident",["SimpleLocal","Nil"],null],[["ADT",["Ident",["SimpleLocal","Square"],{"fname":"","lnum":0,"cnum":0}],[]]],[]],null]]]],null]]]],null]],null]],null]],null]],null]],["LibVar",["Ident",["SimpleLocal","officer_path"],null],null,[["Fun",["Ident",["SimpleLocal","square"],null],["ADT",["Ident",["SimpleLocal","Square"],{"fname":"","lnum":0,"cnum":0}],[]],[["Fun",["Ident",["SimpleLocal","direction"],null],["ADT",["Ident",["SimpleLocal","Direction"],{"fname":"","lnum":0,"cnum":0}],[]],[["Fun",["Ident",["SimpleLocal","distance"],null],["PrimType",["Uint_typ",["Bits32"]]],[["App",["Ident",["SimpleLocal","generate_path"],null],[["Ident",["SimpleLocal","square"],null],["Ident",["SimpleLocal","direction"],null],["Ident",["SimpleLocal","distance"],null]]],null]],null]],null]],null]],["LibVar",["Ident",["SimpleLocal","movement_path"],null],null,[["Fun",["Ident",["SimpleLocal","square"],null],["ADT",["Ident",["SimpleLocal","Square"],{"fname":"","lnum":0,"cnum":0}],[]],[["Fun",["Ident",["SimpleLocal","piece"],null],["ADT",["Ident",["SimpleLocal","Piece"],{"fname":"","lnum":0,"cnum":0}],[]],[["Fun",["Ident",["SimpleLocal","promotion_status"],null],["ADT",["Ident",["SimpleLocal","PromotionStatus"],{"fname":"","lnum":0,"cnum":0}],[]],[["Fun",["Ident",["SimpleLocal","direction"],null],["ADT",["Ident",["SimpleLocal","Direction"],{"fname":"","lnum":0,"cnum":0}],[]],[["Fun",["Ident",["SimpleLocal","distance"],null],["PrimType",["Uint_typ",["Bits32"]]],[["Fun",["Ident",["SimpleLocal","player_1_in_turn"],null],["ADT",["Ident",["SimpleLocal","Bool"],{"fname":"","lnum":0,"cnum":0}],[]],[["MatchExpr",["Ident",["SimpleLocal","piece"],null],[[["Constructor",["Ident",["SimpleLocal","King"],null],[]],[["Let",["Ident",["SimpleLocal","one"],null],null,[["Literal","1"],null],[["Let",["Ident",["SimpleLocal","distance_is_one"],null],null,[["Builtin",[["Builtin_eq"],null],[],[["Ident",["SimpleLocal","one"],null],["Ident",["SimpleLocal","distance"],null]]],null],[["MatchExpr",["Ident",["SimpleLocal","distance_is_one"],null],[[["Constructor",["Ident",["SimpleLocal","True"],null],[]],[["App",["Ident",["SimpleLocal","king_path"],null],[["Ident",["SimpleLocal","square"],null],["Ident",["SimpleLocal","direction"],null]]],null]],[["Constructor",["Ident",["SimpleLocal","False"],null],[]],[["Constr",["Ident",["SimpleLocal","Nil"],null],[["ADT",["Ident",["SimpleLocal","Square"],{"fname":"","lnum":0,"cnum":0}],[]]],[]],null]]]],null]],null]],null]],[["Constructor",["Ident",["SimpleLocal","GoldGeneral"],null],[]],[["Let",["Ident",["SimpleLocal","one"],null],null,[["Literal","1"],null],[["Let",["Ident",["SimpleLocal","distance_is_one"],null],null,[["Builtin",[["Builtin_eq"],null],[],[["Ident",["SimpleLocal","one"],null],["Ident",["SimpleLocal","distance"],null]]],null],[["MatchExpr",["Ident",["SimpleLocal","distance_is_one"],null],[[["Constructor",["Ident",["SimpleLocal","True"],null],[]],[["App",["Ident",["SimpleLocal","gold_path"],null],[["Ident",["SimpleLocal","square"],null],["Ident",["SimpleLocal","direction"],null],["Ident",["SimpleLocal","player_1_in_turn"],null]]],null]],[["Constructor",["Ident",["SimpleLocal","False"],null],[]],[["Constr",["Ident",["SimpleLocal","Nil"],null],[["ADT",["Ident",["SimpleLocal","Square"],{"fname":"","lnum":0,"cnum":0}],[]]],[]],null]]]],null]],null]],null]],[["Constructor",["Ident",["SimpleLocal","SilverGeneral"],null],[]],[["Let",["Ident",["SimpleLocal","one"],null],null,[["Literal","1"],null],[["Let",["Ident",["SimpleLocal","distance_is_one"],null],null,[["Builtin",[["Builtin_eq"],null],[],[["Ident",["SimpleLocal","one"],null],["Ident",["SimpleLocal","distance"],null]]],null],[["MatchExpr",["Ident",["SimpleLocal","distance_is_one"],null],[[["Constructor",["Ident",["SimpleLocal","True"],null],[]],[["MatchExpr",["Ident",["SimpleLocal","promotion_status"],null],[[["Constructor",["Ident",["SimpleLocal","Promoted"],null],[]],[["App",["Ident",["SimpleLocal","gold_path"],null],[["Ident",["SimpleLocal","square"],null],["Ident",["SimpleLocal","direction"],null],["Ident",["SimpleLocal","player_1_in_turn"],null]]],null]],[["Constructor",["Ident",["SimpleLocal","NotPromoted"],null],[]],[["App",["Ident",["SimpleLocal","silver_path"],null],[["Ident",["SimpleLocal","square"],null],["Ident",["SimpleLocal","direction"],null],["Ident",["SimpleLocal","player_1_in_turn"],null]]],null]]]],null]],[["Constructor",["Ident",["SimpleLocal","False"],null],[]],[["Constr",["Ident",["SimpleLocal","Nil"],null],[["ADT",["Ident",["SimpleLocal","Square"],{"fname":"","lnum":0,"cnum":0}],[]]],[]],null]]]],null]],null]],null]],[["Constructor",["Ident",["SimpleLocal","Knight"],null],[]],[["MatchExpr",["Ident",["SimpleLocal","promotion_status"],null],[[["Constructor",["Ident",["SimpleLocal","Promoted"],null],[]],[["Let",["Ident",["SimpleLocal","one"],null],null,[["Literal","1"],null],[["Let",["Ident",["SimpleLocal","distance_is_one"],null],null,[["Builtin",[["Builtin_eq"],null],[],[["Ident",["SimpleLocal","one"],null],["Ident",["SimpleLocal","distance"],null]]],null],[["MatchExpr",["Ident",["SimpleLocal","distance_is_one"],null],[[["Constructor",["Ident",["SimpleLocal","True"],null],[]],[["App",["Ident",["SimpleLocal","gold_path"],null],[["Ident",["SimpleLocal","square"],null],["Ident",["SimpleLocal","direction"],null],["Ident",["SimpleLocal","player_1_in_turn"],null]]],null]],[["Constructor",["Ident",["SimpleLocal","False"],null],[]],[["Constr",["Ident",["SimpleLocal","Nil"],null],[["ADT",["Ident",["SimpleLocal","Square"],{"fname":"","lnum":0,"cnum":0}],[]]],[]],null]]]],null]],null]],null]],[["Constructor",["Ident",["SimpleLocal","NotPromoted"],null],[]],[["Let",["Ident",["SimpleLocal","two"],null],null,[["Literal","2"],null],[["Let",["Ident",["SimpleLocal","distance_is_two"],null],null,[["Builtin",[["Builtin_eq"],null],[],[["Ident",["SimpleLocal","two"],null],["Ident",["SimpleLocal","distance"],null]]],null],[["MatchExpr",["Ident",["SimpleLocal","distance_is_two"],null],[[["Constructor",["Ident",["SimpleLocal","True"],null],[]],[["App",["Ident",["SimpleLocal","knight_path"],null],[["Ident",["SimpleLocal","square"],null],["Ident",["SimpleLocal","direction"],null],["Ident",["SimpleLocal","player_1_in_turn"],null]]],null]],[["Constructor",["Ident",["SimpleLocal","False"],null],[]],[["Constr",["Ident",["SimpleLocal","Nil"],null],[["ADT",["Ident",["SimpleLocal","Square"],{"fname":"","lnum":0,"cnum":0}],[]]],[]],null]]]],null]],null]],null]]]],null]],[["Constructor",["Ident",["SimpleLocal","Pawn"],null],[]],[["Let",["Ident",["SimpleLocal","one"],null],null,[["Literal","1"],null],[["Let",["Ident",["SimpleLocal","distance_is_one"],null],null,[["Builtin",[["Builtin_eq"],null],[],[["Ident",["SimpleLocal","one"],null],["Ident",["SimpleLocal","distance"],null]]],null],[["MatchExpr",["Ident",["SimpleLocal","distance_is_one"],null],[[["Constructor",["Ident",["SimpleLocal","True"],null],[]],[["MatchExpr",["Ident",["SimpleLocal","promotion_status"],null],[[["Constructor",["Ident",["SimpleLocal","Promoted"],null],[]],[["App",["Ident",["SimpleLocal","gold_path"],null],[["Ident",["SimpleLocal","square"],null],["Ident",["SimpleLocal","direction"],null],["Ident",["SimpleLocal","player_1_in_turn"],null]]],null]],[["Constructor",["Ident",["SimpleLocal","NotPromoted"],null],[]],[["App",["Ident",["SimpleLocal","pawn_path"],null],[["Ident",["SimpleLocal","square"],null],["Ident",["SimpleLocal","direction"],null],["Ident",["SimpleLocal","player_1_in_turn"],null]]],null]]]],null]],[["Constructor",["Ident",["SimpleLocal","False"],null],[]],[["Constr",["Ident",["SimpleLocal","Nil"],null],[["ADT",["Ident",["SimpleLocal","Square"],{"fname":"","lnum":0,"cnum":0}],[]]],[]],null]]]],null]],null]],null]],[["Constructor",["Ident",["SimpleLocal","Lance"],null],[]],[["MatchExpr",["Ident",["SimpleLocal","promotion_status"],null],[[["Constructor",["Ident",["SimpleLocal","Promoted"],null],[]],[["Let",["Ident",["SimpleLocal","one"],null],null,[["Literal","1"],null],[["Let",["Ident",["SimpleLocal","distance_is_one"],null],null,[["Builtin",[["Builtin_eq"],null],[],[["Ident",["SimpleLocal","one"],null],["Ident",["SimpleLocal","distance"],null]]],null],[["MatchExpr",["Ident",["SimpleLocal","distance_is_one"],null],[[["Constructor",["Ident",["SimpleLocal","True"],null],[]],[["App",["Ident",["SimpleLocal","gold_path"],null],[["Ident",["SimpleLocal","square"],null],["Ident",["SimpleLocal","direction"],null],["Ident",["SimpleLocal","player_1_in_turn"],null]]],null]],[["Constructor",["Ident",["SimpleLocal","False"],null],[]],[["Constr",["Ident",["SimpleLocal","Nil"],null],[["ADT",["Ident",["SimpleLocal","Square"],{"fname":"","lnum":0,"cnum":0}],[]]],[]],null]]]],null]],null]],null]],[["Constructor",["Ident",["SimpleLocal","NotPromoted"],null],[]],[["Let",["Ident",["SimpleLocal","zero"],null],null,[["Literal","0"],null],[["Let",["Ident",["SimpleLocal","distance_is_greater_that_zero"],null],null,[["Builtin",[["Builtin_lt"],null],[],[["Ident",["SimpleLocal","zero"],null],["Ident",["SimpleLocal","distance"],null]]],null],[["MatchExpr",["Ident",["SimpleLocal","distance_is_greater_that_zero"],null],[[["Constructor",["Ident",["SimpleLocal","True"],null],[]],[["App",["Ident",["SimpleLocal","lance_path"],null],[["Ident",["SimpleLocal","square"],null],["Ident",["SimpleLocal","direction"],null],["Ident",["SimpleLocal","distance"],null],["Ident",["SimpleLocal","player_1_in_turn"],null]]],null]],[["Constructor",["Ident",["SimpleLocal","False"],null],[]],[["Constr",["Ident",["SimpleLocal","Nil"],null],[["ADT",["Ident",["SimpleLocal","Square"],{"fname":"","lnum":0,"cnum":0}],[]]],[]],null]]]],null]],null]],null]]]],null]],[["Constructor",["Ident",["SimpleLocal","Bishop"],null],[]],[["MatchExpr",["Ident",["SimpleLocal","direction"],null],[[["Constructor",["Ident",["SimpleLocal","SouthEast"],null],[]],[["App",["Ident",["SimpleLocal","officer_path"],null],[["Ident",["SimpleLocal","square"],null],["Ident",["SimpleLocal","direction"],null],["Ident",["SimpleLocal","distance"],null]]],null]],[["Constructor",["Ident",["SimpleLocal","SouthWest"],null],[]],[["App",["Ident",["SimpleLocal","officer_path"],null],[["Ident",["SimpleLocal","square"],null],["Ident",["SimpleLocal","direction"],null],["Ident",["SimpleLocal","distance"],null]]],null]],[["Constructor",["Ident",["SimpleLocal","NorthEast"],null],[]],[["App",["Ident",["SimpleLocal","officer_path"],null],[["Ident",["SimpleLocal","square"],null],["Ident",["SimpleLocal","direction"],null],["Ident",["SimpleLocal","distance"],null]]],null]],[["Constructor",["Ident",["SimpleLocal","NorthWest"],null],[]],[["App",["Ident",["SimpleLocal","officer_path"],null],[["Ident",["SimpleLocal","square"],null],["Ident",["SimpleLocal","direction"],null],["Ident",["SimpleLocal","distance"],null]]],null]],[["Wildcard"],[["MatchExpr",["Ident",["SimpleLocal","promotion_status"],null],[[["Constructor",["Ident",["SimpleLocal","NotPromoted"],null],[]],[["Constr",["Ident",["SimpleLocal","Nil"],null],[["ADT",["Ident",["SimpleLocal","Square"],{"fname":"","lnum":0,"cnum":0}],[]]],[]],null]],[["Constructor",["Ident",["SimpleLocal","Promoted"],null],[]],[["Let",["Ident",["SimpleLocal","one"],null],null,[["Literal","1"],null],[["Let",["Ident",["SimpleLocal","distance_is_one"],null],null,[["Builtin",[["Builtin_eq"],null],[],[["Ident",["SimpleLocal","one"],null],["Ident",["SimpleLocal","distance"],null]]],null],[["MatchExpr",["Ident",["SimpleLocal","distance_is_one"],null],[[["Constructor",["Ident",["SimpleLocal","True"],null],[]],[["App",["Ident",["SimpleLocal","officer_path"],null],[["Ident",["SimpleLocal","square"],null],["Ident",["SimpleLocal","direction"],null],["Ident",["SimpleLocal","one"],null]]],null]],[["Constructor",["Ident",["SimpleLocal","False"],null],[]],[["Constr",["Ident",["SimpleLocal","Nil"],null],[["ADT",["Ident",["SimpleLocal","Square"],{"fname":"","lnum":0,"cnum":0}],[]]],[]],null]]]],null]],null]],null]]]],null]]]],null]],[["Constructor",["Ident",["SimpleLocal","Rook"],null],[]],[["MatchExpr",["Ident",["SimpleLocal","direction"],null],[[["Constructor",["Ident",["SimpleLocal","South"],null],[]],[["App",["Ident",["SimpleLocal","officer_path"],null],[["Ident",["SimpleLocal","square"],null],["Ident",["SimpleLocal","direction"],null],["Ident",["SimpleLocal","distance"],null]]],null]],[["Constructor",["Ident",["SimpleLocal","West"],null],[]],[["App",["Ident",["SimpleLocal","officer_path"],null],[["Ident",["SimpleLocal","square"],null],["Ident",["SimpleLocal","direction"],null],["Ident",["SimpleLocal","distance"],null]]],null]],[["Constructor",["Ident",["SimpleLocal","East"],null],[]],[["App",["Ident",["SimpleLocal","officer_path"],null],[["Ident",["SimpleLocal","square"],null],["Ident",["SimpleLocal","direction"],null],["Ident",["SimpleLocal","distance"],null]]],null]],[["Constructor",["Ident",["SimpleLocal","North"],null],[]],[["App",["Ident",["SimpleLocal","officer_path"],null],[["Ident",["SimpleLocal","square"],null],["Ident",["SimpleLocal","direction"],null],["Ident",["SimpleLocal","distance"],null]]],null]],[["Wildcard"],[["MatchExpr",["Ident",["SimpleLocal","promotion_status"],null],[[["Constructor",["Ident",["SimpleLocal","NotPromoted"],null],[]],[["Constr",["Ident",["SimpleLocal","Nil"],null],[["ADT",["Ident",["SimpleLocal","Square"],{"fname":"","lnum":0,"cnum":0}],[]]],[]],null]],[["Constructor",["Ident",["SimpleLocal","Promoted"],null],[]],[["Let",["Ident",["SimpleLocal","one"],null],null,[["Literal","1"],null],[["Let",["Ident",["SimpleLocal","distance_is_one"],null],null,[["Builtin",[["Builtin_eq"],null],[],[["Ident",["SimpleLocal","one"],null],["Ident",["SimpleLocal","distance"],null]]],null],[["MatchExpr",["Ident",["SimpleLocal","distance_is_one"],null],[[["Constructor",["Ident",["SimpleLocal","True"],null],[]],[["App",["Ident",["SimpleLocal","officer_path"],null],[["Ident",["SimpleLocal","square"],null],["Ident",["SimpleLocal","direction"],null],["Ident",["SimpleLocal","one"],null]]],null]],[["Constructor",["Ident",["SimpleLocal","False"],null],[]],[["Constr",["Ident",["SimpleLocal","Nil"],null],[["ADT",["Ident",["SimpleLocal","Square"],{"fname":"","lnum":0,"cnum":0}],[]]],[]],null]]]],null]],null]],null]]]],null]]]],null]]]],null]],null]],null]],null]],null]],null]],null]],["LibVar",["Ident",["SimpleLocal","perform_promotion"],null],null,[["Fun",["Ident",["SimpleLocal","promote"],null],["ADT",["Ident",["SimpleLocal","Bool"],{"fname":"","lnum":0,"cnum":0}],[]],[["Fun",["Ident",["SimpleLocal","promotion_status"],null],["ADT",["Ident",["SimpleLocal","PromotionStatus"],{"fname":"","lnum":0,"cnum":0}],[]],[["Fun",["Ident",["SimpleLocal","origin_row"],null],["PrimType",["Uint_typ",["Bits32"]]],[["Fun",["Ident",["SimpleLocal","target_row"],null],["PrimType",["Uint_typ",["Bits32"]]],[["Fun",["Ident",["SimpleLocal","player_1_in_turn"],null],["ADT",["Ident",["SimpleLocal","Bool"],{"fname":"","lnum":0,"cnum":0}],[]],[["MatchExpr",["Ident",["SimpleLocal","promote"],null],[[["Constructor",["Ident",["SimpleLocal","False"],null],[]],[["Constr",["Ident",["SimpleLocal","Some"],null],[["ADT",["Ident",["SimpleLocal","PromotionStatus"],{"fname":"","lnum":0,"cnum":0}],[]]],[["Ident",["SimpleLocal","promotion_status"],null]]],null]],[["Constructor",["Ident",["SimpleLocal","True"],null],[]],[["MatchExpr",["Ident",["SimpleLocal","promotion_status"],null],[[["Constructor",["Ident",["SimpleLocal","Promoted"],null],[]],[["Constr",["Ident",["SimpleLocal","None"],null],[["ADT",["Ident",["SimpleLocal","PromotionStatus"],{"fname":"","lnum":0,"cnum":0}],[]]],[]],null]],[["Constructor",["Ident",["SimpleLocal","NotPromoted"],null],[]],[["MatchExpr",["Ident",["SimpleLocal","player_1_in_turn"],null],[[["Constructor",["Ident",["SimpleLocal","True"],null],[]],[["Let",["Ident",["SimpleLocal","seven"],null],null,[["Literal","7"],null],[["Let",["Ident",["SimpleLocal","origin_not_in_opponent_territory"],null],null,[["Builtin",[["Builtin_lt"],null],[],[["Ident",["SimpleLocal","origin_row"],null],["Ident",["SimpleLocal","seven"],null]]],null],[["Let",["Ident",["SimpleLocal","target_not_in_opponent_territory"],null],null,[["Builtin",[["Builtin_lt"],null],[],[["Ident",["SimpleLocal","target_row"],null],["Ident",["SimpleLocal","seven"],null]]],null],[["Let",["Ident",["SimpleLocal","not_in_opponent_territory"],null],null,[["App",["Ident",["SimpleLocal","andb"],null],[["Ident",["SimpleLocal","origin_not_in_opponent_territory"],null],["Ident",["SimpleLocal","target_not_in_opponent_territory"],null]]],null],[["MatchExpr",["Ident",["SimpleLocal","not_in_opponent_territory"],null],[[["Constructor",["Ident",["SimpleLocal","True"],null],[]],[["Constr",["Ident",["SimpleLocal","None"],null],[["ADT",["Ident",["SimpleLocal","PromotionStatus"],{"fname":"","lnum":0,"cnum":0}],[]]],[]],null]],[["Constructor",["Ident",["SimpleLocal","False"],null],[]],[["Constr",["Ident",["SimpleLocal","Some"],null],[["ADT",["Ident",["SimpleLocal","PromotionStatus"],{"fname":"","lnum":0,"cnum":0}],[]]],[["Ident",["SimpleLocal","promoted"],null]]],null]]]],null]],null]],null]],null]],null]],[["Constructor",["Ident",["SimpleLocal","False"],null],[]],[["Let",["Ident",["SimpleLocal","three"],null],null,[["Literal","3"],null],[["Let",["Ident",["SimpleLocal","origin_not_in_opponent_territory"],null],null,[["Builtin",[["Builtin_lt"],null],[],[["Ident",["SimpleLocal","three"],null],["Ident",["SimpleLocal","origin_row"],null]]],null],[["Let",["Ident",["SimpleLocal","target_not_in_opponent_territory"],null],null,[["Builtin",[["Builtin_lt"],null],[],[["Ident",["SimpleLocal","three"],null],["Ident",["SimpleLocal","target_row"],null]]],null],[["Let",["Ident",["SimpleLocal","not_in_opponent_territory"],null],null,[["App",["Ident",["SimpleLocal","andb"],null],[["Ident",["SimpleLocal","origin_not_in_opponent_territory"],null],["Ident",["SimpleLocal","target_not_in_opponent_territory"],null]]],null],[["MatchExpr",["Ident",["SimpleLocal","not_in_opponent_territory"],null],[[["Constructor",["Ident",["SimpleLocal","True"],null],[]],[["Constr",["Ident",["SimpleLocal","None"],null],[["ADT",["Ident",["SimpleLocal","PromotionStatus"],{"fname":"","lnum":0,"cnum":0}],[]]],[]],null]],[["Constructor",["Ident",["SimpleLocal","False"],null],[]],[["Constr",["Ident",["SimpleLocal","Some"],null],[["ADT",["Ident",["SimpleLocal","PromotionStatus"],{"fname":"","lnum":0,"cnum":0}],[]]],[["Ident",["SimpleLocal","promoted"],null]]],null]]]],null]],null]],null]],null]],null]]]],null]]]],null]]]],null]],null]],null]],null]],null]],null]],["LibTyp",["Ident",["SimpleLocal","Error"],null],[{"cname":["Ident",["SimpleLocal","GameOver"],null],"c_arg_types":[]},{"cname":["Ident",["SimpleLocal","PlayingOutOfTurn"],null],"c_arg_types":[]},{"cname":["Ident",["SimpleLocal","IllegalAction"],null],"c_arg_types":[]},{"cname":["Ident",["SimpleLocal","InternalError"],null],"c_arg_types":[]}]],["LibVar",["Ident",["SimpleLocal","game_is_over"],null],null,[["Constr",["Ident",["SimpleLocal","GameOver"],null],[],[]],null]],["LibVar",["Ident",["SimpleLocal","playing_out_of_turn"],null],null,[["Constr",["Ident",["SimpleLocal","PlayingOutOfTurn"],null],[],[]],null]],["LibVar",["Ident",["SimpleLocal","illegal_action"],null],null,[["Constr",["Ident",["SimpleLocal","IllegalAction"],null],[],[]],null]],["LibVar",["Ident",["SimpleLocal","internal_error"],null],null,[["Constr",["Ident",["SimpleLocal","InternalError"],null],[],[]],null]],["LibVar",["Ident",["SimpleLocal","mk_error_event"],null],null,[["Fun",["Ident",["SimpleLocal","err"],null],["ADT",["Ident",["SimpleLocal","Error"],{"fname":"","lnum":0,"cnum":0}],[]],[["Let",["Ident",["SimpleLocal","err_code"],null],null,[["MatchExpr",["Ident",["SimpleLocal","err"],null],[[["Constructor",["Ident",["SimpleLocal","GameOver"],null],[]],[["Literal","-1"],null]],[["Constructor",["Ident",["SimpleLocal","PlayingOutOfTurn"],null],[]],[["Literal","-2"],null]],[["Constructor",["Ident",["SimpleLocal","IllegalAction"],null],[]],[["Literal","-3"],null]],[["Constructor",["Ident",["SimpleLocal","InternalError"],null],[]],[["Literal","-999"],null]]]],null],[["Message",[["_eventname",["MLit","ShogiError"]],["err_code",["MVar",["Ident",["SimpleLocal","err_code"],null]]]]],null]],null]],null]],["LibVar",["Ident",["SimpleLocal","mk_winner_event"],null],null,[["Fun",["Ident",["SimpleLocal","current_player"],null],["PrimType",["Bystrx_typ",20]],[["Fun",["Ident",["SimpleLocal","player1"],null],["PrimType",["Bystrx_typ",20]],[["Fun",["Ident",["SimpleLocal","player2"],null],["PrimType",["Bystrx_typ",20]],[["Let",["Ident",["SimpleLocal","current_player_is_one"],null],null,[["Builtin",[["Builtin_eq"],null],[],[["Ident",["SimpleLocal","player1"],null],["Ident",["SimpleLocal","current_player"],null]]],null],[["Let",["Ident",["SimpleLocal","player_no"],null],null,[["MatchExpr",["Ident",["SimpleLocal","current_player_is_one"],null],[[["Constructor",["Ident",["SimpleLocal","True"],null],[]],[["Literal","1"],null]],[["Constructor",["Ident",["SimpleLocal","False"],null],[]],[["Literal","2"],null]]]],null],[["Message",[["_eventname",["MLit","ShogiWinner"]],["winner",["MVar",["Ident",["SimpleLocal","player_no"],null]]]]],null]],null]],null]],null]],null]],null]],["LibVar",["Ident",["SimpleLocal","get_next_player"],null],null,[["Fun",["Ident",["SimpleLocal","current_player"],null],["PrimType",["Bystrx_typ",20]],[["Fun",["Ident",["SimpleLocal","player1"],null],["PrimType",["Bystrx_typ",20]],[["Fun",["Ident",["SimpleLocal","player2"],null],["PrimType",["Bystrx_typ",20]],[["Let",["Ident",["SimpleLocal","current_player_is_one"],null],null,[["Builtin",[["Builtin_eq"],null],[],[["Ident",["SimpleLocal","player1"],null],["Ident",["SimpleLocal","current_player"],null]]],null],[["MatchExpr",["Ident",["SimpleLocal","current_player_is_one"],null],[[["Constructor",["Ident",["SimpleLocal","True"],null],[]],[["Var",["Ident",["SimpleLocal","player2"],null]],null]],[["Constructor",["Ident",["SimpleLocal","False"],null],[]],[["Var",["Ident",["SimpleLocal","player1"],null]],null]]]],null]],null]],null]],null]],null]]]},"elibs":[[["Ident",["SimpleLocal","ShogiLib"],null],null],[["Ident",["SimpleLocal","BoolUtils"],null],null],[["Ident",["SimpleLocal","ListUtils"],null],null]],"contr":{"cname":["Ident",["SimpleLocal","ShogiProc"],null],"cparams":[[["Ident",["SimpleLocal","player1"],null],["PrimType",["Bystrx_typ",20]]],[["Ident",["SimpleLocal","player2"],null],["PrimType",["Bystrx_typ",20]]]],"cconstraint":[["Literal",{"name":["SimpleLocal","True"],"types":[],"lits":[]}],null],"cfields":[[["Ident",["SimpleLocal","board"],null],["MapType",["PrimType",["Uint_typ",["Bits32"]]],["MapType",["PrimType",["Uint_typ",["Bits32"]]],["ADT",["Ident",["SimpleLocal","SquareContents"],{"fname":"","lnum":0,"cnum":0}],[]]]],[["App",["Ident",["SimpleLocal","initial_board"],null],[["Ident",["SimpleLocal","player1"],null],["Ident",["SimpleLocal","player2"],null]]],null]],[["Ident",["SimpleLocal","captured_pieces"],null],["MapType",["PrimType",["Bystrx_typ",20]],["MapType",["PrimType",["Uint_typ",["Bits32"]]],["PrimType",["Uint_typ",["Bits32"]]]]],[["App",["Ident",["SimpleLocal","init_captured_pieces"],null],[["Ident",["SimpleLocal","player1"],null],["Ident",["SimpleLocal","player2"],null]]],null]],[["Ident",["SimpleLocal","player_in_turn"],null],["ADT",["Ident",["SimpleLocal","Option"],{"fname":"","lnum":0,"cnum":0}],[["PrimType",["Bystrx_typ",20]]]],[["Constr",["Ident",["SimpleLocal","Some"],null],[["PrimType",["Bystrx_typ",20]]],[["Ident",["SimpleLocal","player1"],null]]],null]],[["Ident",["SimpleLocal","winner"],null],["ADT",["Ident",["SimpleLocal","Option"],{"fname":"","lnum":0,"cnum":0}],[["PrimType",["Bystrx_typ",20]]]],[["Constr",["Ident",["SimpleLocal","None"],null],[["PrimType",["Bystrx_typ",20]]],[]],null]]],"ccomps":[{"comp_type":["CompProc"],"comp_name":["Ident",["SimpleLocal","InternalErrorEvent"],null],"comp_params":[],"comp_body":[[["Bind",["Ident",["SimpleLocal","none_player"],null],[["Constr",["Ident",["SimpleLocal","None"],null],[["PrimType",["Bystrx_typ",20]]],[]],null]],null],[["Store",["Ident",["SimpleLocal","player_in_turn"],null],["Ident",["SimpleLocal","none_player"],null]],null],[["Bind",["Ident",["SimpleLocal","err"],null],[["Var",["Ident",["SimpleLocal","internal_error"],null]],null]],null],[["Bind",["Ident",["SimpleLocal","e"],null],[["App",["Ident",["SimpleLocal","mk_error_event"],null],[["Ident",["SimpleLocal","err"],null]]],null]],null],[["CreateEvnt",["Ident",["SimpleLocal","e"],null]],null]],"comp_return":null},{"comp_type":["CompProc"],"comp_name":["Ident",["SimpleLocal","IllegalActionEvent"],null],"comp_params":[],"comp_body":[[["Bind",["Ident",["SimpleLocal","err"],null],[["Var",["Ident",["SimpleLocal","illegal_action"],null]],null]],null],[["Bind",["Ident",["SimpleLocal","e"],null],[["App",["Ident",["SimpleLocal","mk_error_event"],null],[["Ident",["SimpleLocal","err"],null]]],null]],null],[["CreateEvnt",["Ident",["SimpleLocal","e"],null]],null]],"comp_return":null},{"comp_type":["CompProc"],"comp_name":["Ident",["SimpleLocal","Winner"],null],"comp_params":[[["Ident",["SimpleLocal","winning_player"],null],["PrimType",["Bystrx_typ",20]]]],"comp_body":[[["Bind",["Ident",["SimpleLocal","none"],null],[["Constr",["Ident",["SimpleLocal","None"],null],[["PrimType",["Bystrx_typ",20]]],[]],null]],null],[["Store",["Ident",["SimpleLocal","player_in_turn"],null],["Ident",["SimpleLocal","none"],null]],null],[["Bind",["Ident",["SimpleLocal","some_winner"],null],[["Constr",["Ident",["SimpleLocal","Some"],null],[["PrimType",["Bystrx_typ",20]]],[["Ident",["SimpleLocal","winning_player"],null]]],null]],null],[["Store",["Ident",["SimpleLocal","winner"],null],["Ident",["SimpleLocal","some_winner"],null]],null]],"comp_return":null},{"comp_type":["CompProc"],"comp_name":["Ident",["SimpleLocal","Resign"],null],"comp_params":[[["Ident",["SimpleLocal","current_player"],null],["PrimType",["Bystrx_typ",20]]]],"comp_body":[[["Bind",["Ident",["SimpleLocal","opponent"],null],[["App",["Ident",["SimpleLocal","get_next_player"],null],[["Ident",["SimpleLocal","current_player"],null],["Ident",["SimpleLocal","player1"],null],["Ident",["SimpleLocal","player2"],null]]],null]],null],[["CallProc",null,["Ident",["SimpleLocal","Winner"],null],[["Ident",["SimpleLocal","opponent"],null]]],null]],"comp_return":null},{"comp_type":["CompProc"],"comp_name":["Ident",["SimpleLocal","PlacePiece"],null],"comp_params":[[["Ident",["SimpleLocal","piece"],null],["ADT",["Ident",["SimpleLocal","Piece"],{"fname":"","lnum":0,"cnum":0}],[]]],[["Ident",["SimpleLocal","square"],null],["ADT",["Ident",["SimpleLocal","Square"],{"fname":"","lnum":0,"cnum":0}],[]]]],"comp_body":[[["Bind",["Ident",["SimpleLocal","piece_no"],null],[["App",["Ident",["SimpleLocal","piece_to_int"],null],[["Ident",["SimpleLocal","piece"],null]]],null]],null],[["MapGet",["Ident",["SimpleLocal","capture_count"],null],["Ident",["SimpleLocal","captured_pieces"],null],[["Ident",["SimpleLocal","_sender"],null],["Ident",["SimpleLocal","piece_no"],null]],true],null],[["MatchStmt",["Ident",["SimpleLocal","capture_count"],null],[[["Constructor",["Ident",["SimpleLocal","None"],null],[]],[[["CallProc",null,["Ident",["SimpleLocal","InternalErrorEvent"],null],[]],null]]],[["Constructor",["Ident",["SimpleLocal","Some"],null],[["Binder",["Ident",["SimpleLocal","count"],null]]]],[[["Bind",["Ident",["SimpleLocal","zero"],null],[["Literal","0"],null]],null],[["Bind",["Ident",["SimpleLocal","has_pieces"],null],[["Builtin",[["Builtin_lt"],null],[],[["Ident",["SimpleLocal","zero"],null],["Ident",["SimpleLocal","count"],null]]],null]],null],[["MatchStmt",["Ident",["SimpleLocal","has_pieces"],null],[[["Constructor",["Ident",["SimpleLocal","False"],null],[]],[[["CallProc",null,["Ident",["SimpleLocal","IllegalActionEvent"],null],[]],null]]],[["Constructor",["Ident",["SimpleLocal","True"],null],[]],[[["MatchStmt",["Ident",["SimpleLocal","square"],null],[[["Constructor",["Ident",["SimpleLocal","Square"],null],[["Binder",["Ident",["SimpleLocal","row"],null]],["Binder",["Ident",["SimpleLocal","column"],null]]]],[[["MapGet",["Ident",["SimpleLocal","target_square_content"],null],["Ident",["SimpleLocal","board"],null],[["Ident",["SimpleLocal","row"],null],["Ident",["SimpleLocal","column"],null]],true],null],[["MatchStmt",["Ident",["SimpleLocal","target_square_content"],null],[[["Constructor",["Ident",["SimpleLocal","Some"],null],[["Constructor",["Ident",["SimpleLocal","Free"],null],[]]]],[[["Bind",["Ident",["SimpleLocal","one"],null],[["Literal","1"],null]],null],[["Bind",["Ident",["SimpleLocal","new_count"],null],[["Builtin",[["Builtin_sub"],null],[],[["Ident",["SimpleLocal","count"],null],["Ident",["SimpleLocal","one"],null]]],null]],null],[["MapUpdate",["Ident",["SimpleLocal","captured_pieces"],null],[["Ident",["SimpleLocal","_sender"],null],["Ident",["SimpleLocal","piece_no"],null]],["Ident",["SimpleLocal","new_count"],null]],null],[["Bind",["Ident",["SimpleLocal","new_contents"],null],[["Constr",["Ident",["SimpleLocal","Occupied"],null],[],[["Ident",["SimpleLocal","piece"],null],["Ident",["SimpleLocal","not_promoted"],null],["Ident",["SimpleLocal","_sender"],null]]],null]],null],[["MapUpdate",["Ident",["SimpleLocal","board"],null],[["Ident",["SimpleLocal","row"],null],["Ident",["SimpleLocal","column"],null]],["Ident",["SimpleLocal","new_contents"],null]],null]]],[["Wildcard"],[[["CallProc",null,["Ident",["SimpleLocal","IllegalActionEvent"],null],[]],null]]]]],null]]]]],null]]]]],null]]]]],null]],"comp_return":null},{"comp_type":["CompProc"],"comp_name":["Ident",["SimpleLocal","PerformMoveAndPromote"],null],"comp_params":[[["Ident",["SimpleLocal","current_player"],null],["PrimType",["Bystrx_typ",20]]],[["Ident",["SimpleLocal","piece"],null],["ADT",["Ident",["SimpleLocal","Piece"],{"fname":"","lnum":0,"cnum":0}],[]]],[["Ident",["SimpleLocal","promote"],null],["ADT",["Ident",["SimpleLocal","Bool"],{"fname":"","lnum":0,"cnum":0}],[]]],[["Ident",["SimpleLocal","promotion_status"],null],["ADT",["Ident",["SimpleLocal","PromotionStatus"],{"fname":"","lnum":0,"cnum":0}],[]]],[["Ident",["SimpleLocal","row"],null],["PrimType",["Uint_typ",["Bits32"]]]],[["Ident",["SimpleLocal","column"],null],["PrimType",["Uint_typ",["Bits32"]]]],[["Ident",["SimpleLocal","target_row"],null],["PrimType",["Uint_typ",["Bits32"]]]],[["Ident",["SimpleLocal","target_column"],null],["PrimType",["Uint_typ",["Bits32"]]]],[["Ident",["SimpleLocal","player_1_moves"],null],["ADT",["Ident",["SimpleLocal","Bool"],{"fname":"","lnum":0,"cnum":0}],[]]]],"comp_body":[[["Bind",["Ident",["SimpleLocal","new_promotion_status_opt"],null],[["App",["Ident",["SimpleLocal","perform_promotion"],null],[["Ident",["SimpleLocal","promote"],null],["Ident",["SimpleLocal","promotion_status"],null],["Ident",["SimpleLocal","row"],null],["Ident",["SimpleLocal","target_row"],null],["Ident",["SimpleLocal","player_1_moves"],null]]],null]],null],[["MatchStmt",["Ident",["SimpleLocal","new_promotion_status_opt"],null],[[["Constructor",["Ident",["SimpleLocal","None"],null],[]],[[["CallProc",null,["Ident",["SimpleLocal","IllegalActionEvent"],null],[]],null]]],[["Constructor",["Ident",["SimpleLocal","Some"],null],[["Binder",["Ident",["SimpleLocal","new_promotion_status"],null]]]],[[["MapUpdate",["Ident",["SimpleLocal","board"],null],[["Ident",["SimpleLocal","row"],null],["Ident",["SimpleLocal","column"],null]],["Ident",["SimpleLocal","free"],null]],null],[["Bind",["Ident",["SimpleLocal","new_contents_at_target"],null],[["Constr",["Ident",["SimpleLocal","Occupied"],null],[],[["Ident",["SimpleLocal","piece"],null],["Ident",["SimpleLocal","new_promotion_status"],null],["Ident",["SimpleLocal","current_player"],null]]],null]],null],[["MapUpdate",["Ident",["SimpleLocal","board"],null],[["Ident",["SimpleLocal","target_row"],null],["Ident",["SimpleLocal","target_column"],null]],["Ident",["SimpleLocal","new_contents_at_target"],null]],null]]]]],null]],"comp_return":null},{"comp_type":["CompProc"],"comp_name":["Ident",["SimpleLocal","MovePiece"],null],"comp_params":[[["Ident",["SimpleLocal","current_player"],null],["PrimType",["Bystrx_typ",20]]],[["Ident",["SimpleLocal","square"],null],["ADT",["Ident",["SimpleLocal","Square"],{"fname":"","lnum":0,"cnum":0}],[]]],[["Ident",["SimpleLocal","direction"],null],["ADT",["Ident",["SimpleLocal","Direction"],{"fname":"","lnum":0,"cnum":0}],[]]],[["Ident",["SimpleLocal","distance"],null],["PrimType",["Uint_typ",["Bits32"]]]],[["Ident",["SimpleLocal","promote"],null],["ADT",["Ident",["SimpleLocal","Bool"],{"fname":"","lnum":0,"cnum":0}],[]]]],"comp_body":[[["MatchStmt",["Ident",["SimpleLocal","square"],null],[[["Constructor",["Ident",["SimpleLocal","Square"],null],[["Binder",["Ident",["SimpleLocal","row"],null]],["Binder",["Ident",["SimpleLocal","column"],null]]]],[[["MapGet",["Ident",["SimpleLocal","contents"],null],["Ident",["SimpleLocal","board"],null],[["Ident",["SimpleLocal","row"],null],["Ident",["SimpleLocal","column"],null]],true],null],[["MatchStmt",["Ident",["SimpleLocal","contents"],null],[[["Constructor",["Ident",["SimpleLocal","Some"],null],[["Constructor",["Ident",["SimpleLocal","Occupied"],null],[["Binder",["Ident",["SimpleLocal","piece"],null]],["Binder",["Ident",["SimpleLocal","promotion_status"],null]],["Binder",["Ident",["SimpleLocal","owner"],null]]]]]],[[["Bind",["Ident",["SimpleLocal","correct_owner"],null],[["Builtin",[["Builtin_eq"],null],[],[["Ident",["SimpleLocal","owner"],null],["Ident",["SimpleLocal","current_player"],null]]],null]],null],[["MatchStmt",["Ident",["SimpleLocal","correct_owner"],null],[[["Constructor",["Ident",["SimpleLocal","False"],null],[]],[[["CallProc",null,["Ident",["SimpleLocal","IllegalActionEvent"],null],[]],null]]],[["Constructor",["Ident",["SimpleLocal","True"],null],[]],[[["Bind",["Ident",["SimpleLocal","player_1_moves"],null],[["Builtin",[["Builtin_eq"],null],[],[["Ident",["SimpleLocal","current_player"],null],["Ident",["SimpleLocal","player1"],null]]],null]],null],[["Bind",["Ident",["SimpleLocal","path"],null],[["App",["Ident",["SimpleLocal","movement_path"],null],[["Ident",["SimpleLocal","square"],null],["Ident",["SimpleLocal","piece"],null],["Ident",["SimpleLocal","promotion_status"],null],["Ident",["SimpleLocal","direction"],null],["Ident",["SimpleLocal","distance"],null],["Ident",["SimpleLocal","player_1_moves"],null]]],null]],null],[["MatchStmt",["Ident",["SimpleLocal","path"],null],[[["Constructor",["Ident",["SimpleLocal","Nil"],null],[]],[[["CallProc",null,["Ident",["SimpleLocal","IllegalActionEvent"],null],[]],null]]],[["Constructor",["Ident",["SimpleLocal","Cons"],null],[["Constructor",["Ident",["SimpleLocal","Square"],null],[["Binder",["Ident",["SimpleLocal","target_row"],null]],["Binder",["Ident",["SimpleLocal","target_column"],null]]]],["Binder",["Ident",["SimpleLocal","intervening_squares"],null]]]],[[["Load",["Ident",["SimpleLocal","board_tmp"],null],["Ident",["SimpleLocal","board"],null]],null],[["Bind",["Ident",["SimpleLocal","blocked_path"],null],[["Let",["Ident",["SimpleLocal","exister"],null],null,[["TApp",["Ident",["SimpleLocal","list_exists"],null],[["ADT",["Ident",["SimpleLocal","Square"],{"fname":"","lnum":0,"cnum":0}],[]]]],null],[["Let",["Ident",["SimpleLocal","occupied_predicate"],null],null,[["Fun",["Ident",["SimpleLocal","square"],null],["ADT",["Ident",["SimpleLocal","Square"],{"fname":"","lnum":0,"cnum":0}],[]],[["MatchExpr",["Ident",["SimpleLocal","square"],null],[[["Constructor",["Ident",["SimpleLocal","Square"],null],[["Binder",["Ident",["SimpleLocal","row"],null]],["Binder",["Ident",["SimpleLocal","column"],null]]]],[["Let",["Ident",["SimpleLocal","row_contents"],null],null,[["Builtin",[["Builtin_get"],null],[],[["Ident",["SimpleLocal","board_tmp"],null],["Ident",["SimpleLocal","row"],null]]],null],[["MatchExpr",["Ident",["SimpleLocal","row_contents"],null],[[["Constructor",["Ident",["SimpleLocal","None"],null],[]],[["Constr",["Ident",["SimpleLocal","False"],null],[],[]],null]],[["Constructor",["Ident",["SimpleLocal","Some"],null],[["Binder",["Ident",["SimpleLocal","row_map"],null]]]],[["Let",["Ident",["SimpleLocal","contents"],null],null,[["Builtin",[["Builtin_get"],null],[],[["Ident",["SimpleLocal","row_map"],null],["Ident",["SimpleLocal","column"],null]]],null],[["MatchExpr",["Ident",["SimpleLocal","contents"],null],[[["Constructor",["Ident",["SimpleLocal","Some"],null],[["Constructor",["Ident",["SimpleLocal","Occupied"],null],[["Wildcard"],["Wildcard"],["Wildcard"]]]]],[["Constr",["Ident",["SimpleLocal","True"],null],[],[]],null]],[["Constructor",["Ident",["SimpleLocal","Some"],null],[["Constructor",["Ident",["SimpleLocal","Free"],null],[]]]],[["Constr",["Ident",["SimpleLocal","False"],null],[],[]],null]],[["Constructor",["Ident",["SimpleLocal","None"],null],[]],[["Constr",["Ident",["SimpleLocal","False"],null],[],[]],null]]]],null]],null]]]],null]],null]]]],null]],null],[["App",["Ident",["SimpleLocal","exister"],null],[["Ident",["SimpleLocal","occupied_predicate"],null],["Ident",["SimpleLocal","intervening_squares"],null]]],null]],null]],null]],null],[["MatchStmt",["Ident",["SimpleLocal","blocked_path"],null],[[["Constructor",["Ident",["SimpleLocal","True"],null],[]],[[["CallProc",null,["Ident",["SimpleLocal","IllegalActionEvent"],null],[]],null]]],[["Constructor",["Ident",["SimpleLocal","False"],null],[]],[[["MapGet",["Ident",["SimpleLocal","contents_at_target"],null],["Ident",["SimpleLocal","board"],null],[["Ident",["SimpleLocal","target_row"],null],["Ident",["SimpleLocal","target_column"],null]],true],null],[["MatchStmt",["Ident",["SimpleLocal","contents_at_target"],null],[[["Constructor",["Ident",["SimpleLocal","None"],null],[]],[[["CallProc",null,["Ident",["SimpleLocal","IllegalActionEvent"],null],[]],null]]],[["Constructor",["Ident",["SimpleLocal","Some"],null],[["Constructor",["Ident",["SimpleLocal","Free"],null],[]]]],[[["CallProc",null,["Ident",["SimpleLocal","PerformMoveAndPromote"],null],[["Ident",["SimpleLocal","current_player"],null],["Ident",["SimpleLocal","piece"],null],["Ident",["SimpleLocal","promote"],null],["Ident",["SimpleLocal","promotion_status"],null],["Ident",["SimpleLocal","row"],null],["Ident",["SimpleLocal","column"],null],["Ident",["SimpleLocal","target_row"],null],["Ident",["SimpleLocal","target_column"],null],["Ident",["SimpleLocal","player_1_moves"],null]]],null]]],[["Constructor",["Ident",["SimpleLocal","Some"],null],[["Constructor",["Ident",["SimpleLocal","Occupied"],null],[["Binder",["Ident",["SimpleLocal","captured_piece"],null]],["Wildcard"],["Binder",["Ident",["SimpleLocal","captured_owner"],null]]]]]],[[["Bind",["Ident",["SimpleLocal","captured_owner_is_current_player"],null],[["Builtin",[["Builtin_eq"],null],[],[["Ident",["SimpleLocal","captured_owner"],null],["Ident",["SimpleLocal","current_player"],null]]],null]],null],[["MatchStmt",["Ident",["SimpleLocal","captured_owner_is_current_player"],null],[[["Constructor",["Ident",["SimpleLocal","True"],null],[]],[[["CallProc",null,["Ident",["SimpleLocal","IllegalActionEvent"],null],[]],null]]],[["Constructor",["Ident",["SimpleLocal","False"],null],[]],[[["CallProc",null,["Ident",["SimpleLocal","PerformMoveAndPromote"],null],[["Ident",["SimpleLocal","current_player"],null],["Ident",["SimpleLocal","piece"],null],["Ident",["SimpleLocal","promote"],null],["Ident",["SimpleLocal","promotion_status"],null],["Ident",["SimpleLocal","row"],null],["Ident",["SimpleLocal","column"],null],["Ident",["SimpleLocal","target_row"],null],["Ident",["SimpleLocal","target_column"],null],["Ident",["SimpleLocal","player_1_moves"],null]]],null],[["MatchStmt",["Ident",["SimpleLocal","captured_piece"],null],[[["Constructor",["Ident",["SimpleLocal","King"],null],[]],[[["CallProc",null,["Ident",["SimpleLocal","Winner"],null],[["Ident",["SimpleLocal","current_player"],null]]],null]]],[["Wildcard"],[[["Bind",["Ident",["SimpleLocal","captured_piece_no"],null],[["App",["Ident",["SimpleLocal","piece_to_int"],null],[["Ident",["SimpleLocal","captured_piece"],null]]],null]],null],[["MapGet",["Ident",["SimpleLocal","captured_count_opt"],null],["Ident",["SimpleLocal","captured_pieces"],null],[["Ident",["SimpleLocal","current_player"],null],["Ident",["SimpleLocal","captured_piece_no"],null]],true],null],[["MatchStmt",["Ident",["SimpleLocal","captured_count_opt"],null],[[["Constructor",["Ident",["SimpleLocal","None"],null],[]],[[["CallProc",null,["Ident",["SimpleLocal","InternalErrorEvent"],null],[]],null]]],[["Constructor",["Ident",["SimpleLocal","Some"],null],[["Binder",["Ident",["SimpleLocal","count"],null]]]],[[["Bind",["Ident",["SimpleLocal","one"],null],[["Literal","1"],null]],null],[["Bind",["Ident",["SimpleLocal","new_captured_count"],null],[["Builtin",[["Builtin_add"],null],[],[["Ident",["SimpleLocal","count"],null],["Ident",["SimpleLocal","one"],null]]],null]],null],[["MapUpdate",["Ident",["SimpleLocal","captured_pieces"],null],[["Ident",["SimpleLocal","current_player"],null],["Ident",["SimpleLocal","captured_piece_no"],null]],["Ident",["SimpleLocal","new_captured_count"],null]],null]]]]],null]]]]],null]]]]],null]]]]],null]]]]],null]]]]],null]]]]],null]]],[["Wildcard"],[[["CallProc",null,["Ident",["SimpleLocal","IllegalActionEvent"],null],[]],null]]]]],null]]]]],null]],"comp_return":null},{"comp_type":["CompTrans"],"comp_name":["Ident",["SimpleLocal","MoveAction"],null],"comp_params":[[["Ident",["SimpleLocal","row"],null],["PrimType",["Uint_typ",["Bits32"]]]],[["Ident",["SimpleLocal","column"],null],["PrimType",["Uint_typ",["Bits32"]]]],[["Ident",["SimpleLocal","direction"],null],["ADT",["Ident",["SimpleLocal","Direction"],{"fname":"","lnum":0,"cnum":0}],[]]],[["Ident",["SimpleLocal","distance"],null],["PrimType",["Uint_typ",["Bits32"]]]],[["Ident",["SimpleLocal","promote"],null],["ADT",["Ident",["SimpleLocal","Bool"],{"fname":"","lnum":0,"cnum":0}],[]]]],"comp_body":[[["Bind",["Ident",["SimpleLocal","square"],null],[["Constr",["Ident",["SimpleLocal","Square"],null],[],[["Ident",["SimpleLocal","row"],null],["Ident",["SimpleLocal","column"],null]]],null]],null],[["Bind",["Ident",["SimpleLocal","zero"],null],[["Literal","0"],null]],null],[["Bind",["Ident",["SimpleLocal","move"],null],[["Constr",["Ident",["SimpleLocal","Move"],null],[],[["Ident",["SimpleLocal","square"],null],["Ident",["SimpleLocal","direction"],null],["Ident",["SimpleLocal","distance"],null],["Ident",["SimpleLocal","promote"],null]]],null]],null],[["Bind",["Ident",["SimpleLocal","msg"],null],[["Message",[["_tag",["MLit","PlayerAction"]],["_amount",["MVar",["Ident",["SimpleLocal","zero"],null]]],["_recipient",["MVar",["Ident",["SimpleLocal","_this_address"],null]]],["action",["MVar",["Ident",["SimpleLocal","move"],null]]]]],null]],null],[["Bind",["Ident",["SimpleLocal","nil_msg"],null],[["Constr",["Ident",["SimpleLocal","Nil"],null],[["PrimType",["Msg_typ"]]],[]],null]],null],[["Bind",["Ident",["SimpleLocal","msgs"],null],[["Constr",["Ident",["SimpleLocal","Cons"],null],[["PrimType",["Msg_typ"]]],[["Ident",["SimpleLocal","msg"],null],["Ident",["SimpleLocal","nil_msg"],null]]],null]],null],[["SendMsgs",["Ident",["SimpleLocal","msgs"],null]],null]],"comp_return":null},{"comp_type":["CompTrans"],"comp_name":["Ident",["SimpleLocal","PlayerAction"],null],"comp_params":[[["Ident",["SimpleLocal","action"],null],["ADT",["Ident",["SimpleLocal","Action"],{"fname":"","lnum":0,"cnum":0}],[]]]],"comp_body":[[["Bind",["Ident",["SimpleLocal","false"],null],[["Constr",["Ident",["SimpleLocal","False"],null],[],[]],null]],null],[["Bind",["Ident",["SimpleLocal","true"],null],[["Constr",["Ident",["SimpleLocal","True"],null],[],[]],null]],null],[["Load",["Ident",["SimpleLocal","current_player_opt"],null],["Ident",["SimpleLocal","player_in_turn"],null]],null],[["MatchStmt",["Ident",["SimpleLocal","current_player_opt"],null],[[["Constructor",["Ident",["SimpleLocal","None"],null],[]],[[["Bind",["Ident",["SimpleLocal","err"],null],[["Var",["Ident",["SimpleLocal","game_is_over"],null]],null]],null],[["Bind",["Ident",["SimpleLocal","e"],null],[["App",["Ident",["SimpleLocal","mk_error_event"],null],[["Ident",["SimpleLocal","err"],null]]],null]],null],[["CreateEvnt",["Ident",["SimpleLocal","e"],null]],null]]],[["Constructor",["Ident",["SimpleLocal","Some"],null],[["Binder",["Ident",["SimpleLocal","current_player"],null]]]],[[["Bind",["Ident",["SimpleLocal","correct_player"],null],[["Builtin",[["Builtin_eq"],null],[],[["Ident",["SimpleLocal","_sender"],null],["Ident",["SimpleLocal","current_player"],null]]],null]],null],[["MatchStmt",["Ident",["SimpleLocal","correct_player"],null],[[["Constructor",["Ident",["SimpleLocal","False"],null],[]],[[["Bind",["Ident",["SimpleLocal","err"],null],[["Var",["Ident",["SimpleLocal","playing_out_of_turn"],null]],null]],null],[["Bind",["Ident",["SimpleLocal","e"],null],[["App",["Ident",["SimpleLocal","mk_error_event"],null],[["Ident",["SimpleLocal","err"],null]]],null]],null],[["CreateEvnt",["Ident",["SimpleLocal","e"],null]],null]]],[["Constructor",["Ident",["SimpleLocal","True"],null],[]],[[["MatchStmt",["Ident",["SimpleLocal","action"],null],[[["Constructor",["Ident",["SimpleLocal","Resign"],null],[]],[[["CallProc",null,["Ident",["SimpleLocal","Resign"],null],[["Ident",["SimpleLocal","current_player"],null]]],null]]],[["Constructor",["Ident",["SimpleLocal","Place"],null],[["Binder",["Ident",["SimpleLocal","piece"],null]],["Binder",["Ident",["SimpleLocal","square"],null]]]],[[["CallProc",null,["Ident",["SimpleLocal","PlacePiece"],null],[["Ident",["SimpleLocal","piece"],null],["Ident",["SimpleLocal","square"],null]]],null]]],[["Constructor",["Ident",["SimpleLocal","Move"],null],[["Binder",["Ident",["SimpleLocal","square"],null]],["Binder",["Ident",["SimpleLocal","direction"],null]],["Binder",["Ident",["SimpleLocal","distance"],null]],["Binder",["Ident",["SimpleLocal","promote"],null]]]],[[["CallProc",null,["Ident",["SimpleLocal","MovePiece"],null],[["Ident",["SimpleLocal","current_player"],null],["Ident",["SimpleLocal","square"],null],["Ident",["SimpleLocal","direction"],null],["Ident",["SimpleLocal","distance"],null],["Ident",["SimpleLocal","promote"],null]]],null]]]]],null]]]]],null],[["Load",["Ident",["SimpleLocal","win"],null],["Ident",["SimpleLocal","winner"],null]],null],[["MatchStmt",["Ident",["SimpleLocal","win"],null],[[["Constructor",["Ident",["SimpleLocal","Some"],null],[["Binder",["Ident",["SimpleLocal","player"],null]]]],[[["Bind",["Ident",["SimpleLocal","e"],null],[["App",["Ident",["SimpleLocal","mk_winner_event"],null],[["Ident",["SimpleLocal","player"],null],["Ident",["SimpleLocal","player1"],null],["Ident",["SimpleLocal","player2"],null]]],null]],null],[["CreateEvnt",["Ident",["SimpleLocal","e"],null]],null]]],[["Constructor",["Ident",["SimpleLocal","None"],null],[]],[[["Bind",["Ident",["SimpleLocal","next_player"],null],[["App",["Ident",["SimpleLocal","get_next_player"],null],[["Ident",["SimpleLocal","current_player"],null],["Ident",["SimpleLocal","player1"],null],["Ident",["SimpleLocal","player2"],null]]],null]],null],[["Bind",["Ident",["SimpleLocal","next_player_opt"],null],[["Constr",["Ident",["SimpleLocal","Some"],null],[["PrimType",["Bystrx_typ",20]]],[["Ident",["SimpleLocal","next_player"],null]]],null]],null],[["Store",["Ident",["SimpleLocal","player_in_turn"],null],["Ident",["SimpleLocal","next_player_opt"],null]],null]]]]],null]]]]],null]],"comp_return":null}]}}
